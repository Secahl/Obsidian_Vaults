### Locating an existing DTD file to repurpose 
  
Since this XXE attack involves repurposing an existing DTD on the server filesystem, a key requirement is to locate a suitable file. This is actually quite straightforward. Because the application returns any error messages thrown by the XML parser, you can easily _enumerate local DTD files just by attempting to load them from within the internal DTD._  
  
**For example**, Linux systems using the GNOME desktop environment often have a DTD file at
>`/usr/share/yelp/dtd/docbookx.dtd`.  

You can test whether this file is present by submitting the following XXE payload, which will cause an error if the file is missing:  
  
```xml
<!DOCTYPE foo [  
                 <!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">  
                 %local_dtd;  
             ]>

```  
  
After you have tested a list of common DTD files to locate a file that is present, you then need to obtain a copy of the file and review it to find an entity that you can redefine.
>_Since many common systems that include DTD files are open source, you can normally quickly obtain a copy of files through internet search._  
  
 
 >LAB [Exploiting XXE to retrieve data by repurposing a local DTD](https://portswigger.net/web-security/xxe/blind/lab-xxe-trigger-error-message-by-repurposing-local-dtd)